# configs/resources.yaml

Resources:
  UserTable:
    Type: 'AWS::DynamoDB::Table'
    Properties:
      TableName: ${self:custom.userTableName}
      AttributeDefinitions:
        - AttributeName: id # PK: ì‚¬ìš©ì ê³ ìœ  ID
          AttributeType: S
      KeySchema:
        - AttributeName: id
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST # ì˜¨ë””ë§¨ë“œ (Serverless í™˜ê²½ì— ì í•©)
      # StreamSpecification:
      #   StreamViewType: NEW_AND_OLD_IMAGES # í•„ìš”ì‹œ DDB Streams í™œì„±í™”

  ChatRoomTable:
    Type: 'AWS::DynamoDB::Table'
    Properties:
      TableName: ${self:custom.chatRoomTableName}
      AttributeDefinitions:
        - AttributeName: id # PK: ì±„íŒ…ë°© ê³ ìœ  ID
          AttributeType: S
        - AttributeName: userId
          AttributeType: S
      KeySchema:
        - AttributeName: id
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      # ğŸŒŸ GSI ì¶”ê°€ (ì„ íƒ): ì‚¬ìš©ìê°€ ì°¸ì—¬í•œ ì±„íŒ…ë°© ëª©ë¡ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ê¸° ìœ„í•¨
      GlobalSecondaryIndexes:
        - IndexName: UserIndex
          KeySchema:
            - AttributeName: userId # GSI Partition Key (PK)
              KeyType: HASH
          Projection:
            ProjectionType: KEYS_ONLY # ë¹„ìš© ì ˆê°ì„ ìœ„í•´ í‚¤ë§Œ íˆ¬ì˜
          ProvisionedThroughput:
            ReadCapacityUnits: 1
            WriteCapacityUnits: 1


  ChatMessageTable:
    Type: 'AWS::DynamoDB::Table'
    Properties:
      TableName: ${self:custom.chatMessageTableName}
      AttributeDefinitions:
        - AttributeName: PK # ì±„íŒ…ë°© ID (íŒŒí‹°ì…˜ í‚¤)
          AttributeType: S
        - AttributeName: SK # íƒ€ì„ìŠ¤íƒ¬í”„ (ì •ë ¬ í‚¤)
          AttributeType: S
      KeySchema:
        - AttributeName: PK
          KeyType: HASH
        - AttributeName: SK
          KeyType: RANGE
      BillingMode: PAY_PER_REQUEST
      # ğŸŒŸ TTL ì„¤ì • (ì„ íƒ): ì˜¤ë˜ëœ ë©”ì‹œì§€ ìë™ ì‚­ì œ (ë¡œê·¸ì„± ë°ì´í„° ê´€ë¦¬ì— ìœ ìš©)
      TimeToLiveSpecification:
        AttributeName: expirationTime # TTL ì†ì„± ì´ë¦„ (UNIX Timestamp)
        Enabled: true

